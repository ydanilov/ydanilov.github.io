(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[55],{1477:function(t,e,n){"use strict";n.r(e),n.d(e,{ScreenshoterRouter:function(){return L},startScreenshoter:function(){return W}});var r=n(354),o=n(675),i=n(1489),a=n(1478),u=n(322),c=n(308),s=r.createContext({}),l=n(343),p=n(1382),d=n(340),f=n(351),h=n(1387),m=n(1303),v=n(349),g=n(1384),y=n(312),w=n(1215),b=n(346),O=n(323);function _(t,e,n,r,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void n(t)}u.done?e(c):Promise.resolve(c).then(r,o)}function E(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){_(i,r,o,a,u,"next",t)}function u(t){_(i,r,o,a,u,"throw",t)}a(void 0)}))}}function S(t){return function(t){if(Array.isArray(t))return M(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||j(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function P(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function Z(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?P(Object(n),!0).forEach((function(e){x(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function x(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function C(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=t[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!e||n.length!==e);r=!0);}catch(t){o=!0,i=t}finally{try{r||null==u.return||u.return()}finally{if(o)throw i}}return n}(t,e)||j(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function j(t,e){if(t){if("string"==typeof t)return M(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?M(t,e):void 0}}function M(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var A=function(t){var e=t.pageId,n=t.ready,o=(0,r.useContext)(s),i=o.project,a=o.isPdf,_=o.isTemplate;return(0,r.useEffect)((function(){if(i){O.Z.setPageClass(),a&&(Modernizr.retina=!0);var t=window.ServerData.mag;(t=u.default.defaults(t,p.Z.prototype)).model=new v.w(t,{parse:!0});var r=C(location.search.match(/viewport=(\w+)/)||[],2)[1]||t.getMagViewport();t.viewport=r;var o={navigate:function(){},setUrlString:function(){},setTitle:function(){},getMagUri:function(){return u.default.isEmpty(t.user)?t.num_id+"/":t.user.uri+"/"+(t.uri||t.num_id)+"/"},go:function(){},sendReadyEvent:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=u.default.defaults(t,{page:{}});if(window.loadNotifier){var n,o,i,a;if(e.error)return window.loadNotifier({error:e.error});window.loadNotifier({width:null===(n=e.page)||void 0===n?void 0:n.width,height:(null===(o=e.page)||void 0===o||null===(i=o["viewport_".concat(r)])||void 0===i?void 0:i.height)||(null===(a=e.page)||void 0===a?void 0:a.height)})}}};t.hasNewTextWidgets()&&(0,m.IB)("screenshoter"),(0,b._)("viewer.scaleScreenshots")||(0,b._)("constructor.mobileScreenshots")||t.getViewportWidth(l.sJ.Default)!==l.ZP.dictionary[l.sJ.Default].width?(t.setViewerOptions(r),t.viewOpts.scalableviewer=!0,t.opts.scalableviewer=!0):(t.viewOpts=Z(Z({},t.model.get("opts")),{},{scalableviewer:!1}),t.opts.scalableviewer=!1),t.router=o,t.router.mag=t,Modernizr.addTest("screenshot-mode",(function(){return!0})),Modernizr.addTest("screenshot-pdf-mode",(function(){return!!a})),a||f.Z.setShortList(f.Z.getVeryShortList(t.edit_params&&t.edit_params.fonts)),window.RM.screenshot=e,window.RM.screenshotMode=n?"published":"preview",document.title=e;var s=u.default.findWhere(t.pages,{_id:e});if(!s)return;if(t.hasSummary&&n){var P=[].concat(S(t.globalWidgets||[]),S(t.aboveAllWidgets||[]));s.widgetsData=[].concat(S(s.widgetsData||[]),S(P)),s.wids=[].concat(S(s.wids),S(P.map((function(t){return t._id})).filter((function(t){return!s.wids.includes(t)}))))}else if(_)s.wids=u.default.filter(s.wids,(function(t){return!t.is_global}));else{var x=(0,u.default)(t.pages).chain().map((function(t){return t.wids})).flatten().filter((function(t){return!(!t.is_global||t.pid===s._id)})).map((function(t){return t.is_above=!1,t})).value();s.wids=s.wids.concat(x)}t.$pages_container=(0,y.ZP)("#mags"),(0,h.preloadWidgets)(d.default.usedWidgets([s])).then(E(regeneratorRuntime.mark((function e(){var n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new g.Z({mag:t,router:t.router,pageData:s,$container:t.$pages_container}),t.eCommerceManager=new w.ZP(t.router,t,c.Z.environment.viewer,n),e.next=4,n.render().show();case 4:n.loadForScreenshotMode(),f.Z.generateCSS("paragraph","viewer",document,t.edit_params&&t.edit_params.paragraph_styles),f.Z.generateCSS("link","viewer",document,t.edit_params&&t.edit_params.link_styles),r=f.Z.getUsedFontsFromWidgetsModels({includeCustom:!0,customList:u.default.filter(t.edit_params&&t.edit_params.fonts,(function(t){return"custom"===t.provider})),models:n.widgets}),f.Z.appendFontsCssToDocument({version:"edit",fonts:r});case 9:case"end":return e.stop()}}),e)}))))}}),[]),r.createElement("div",null)},k=function(){var t=(0,a.UO)(),e=t.pageId,n=t.ready;return r.createElement(A,{pageId:e,ready:!!n})},R=n(1490),I=n(602);function D(t){var e=document.getElementById("root");I.hydrate(r.createElement(t,function(){try{var t=document.getElementById("__RM_PROPS__");return null!=t&&t.textContent?JSON.parse(t.innerText):{}}catch(t){return{}}}()),e)}function T(t,e){if(null==t)return{};var n,r,o=function(t,e){if(null==t)return{};var n,r,o={},i=Object.keys(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||(o[n]=t[n]);return o}(t,e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(r=0;r<i.length;r++)n=i[r],e.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(t,n)&&(o[n]=t[n])}return o}var L=function(t){var e=t.location,n=t.ssr,u=T(t,["location","ssr"]),c=function(t){var o=t.children;return n?r.createElement(a.gx,{location:e},o):r.createElement(i.VK,null,o)};return r.createElement(s.Provider,{value:u},r.createElement(o.Z,null,r.createElement(R.Z,null),r.createElement(c,null,r.createElement(a.rs,null,r.createElement(a.AW,{path:["/_singlepage:ready(/ready|)/:mag/:pageId"]},r.createElement(k,null))))))},W=function(){D(L)}},1478:function(t,e,n){"use strict";n.d(e,{AW:function(){return y},F0:function(){return h},gx:function(){return S},rs:function(){return P},s6:function(){return f},LX:function(){return g},UO:function(){return x}});var r=n(1484),o=n(354),i=(n(664),n(1485)),a=n(1479),u=n(1486),c=n(1487),s=n(1480),l=n.n(s),p=(n(1482),n(1488)),d=(n(656),function(t){var e=(0,a.Z)();return e.displayName=t,e}("Router-History")),f=function(t){var e=(0,a.Z)();return e.displayName=t,e}("Router"),h=function(t){function e(e){var n;return(n=t.call(this,e)||this).state={location:e.history.location},n._isMounted=!1,n._pendingLocation=null,e.staticContext||(n.unlisten=e.history.listen((function(t){n._isMounted?n.setState({location:t}):n._pendingLocation=t}))),n}(0,r.Z)(e,t),e.computeRootMatch=function(t){return{path:"/",url:"/",params:{},isExact:"/"===t}};var n=e.prototype;return n.componentDidMount=function(){this._isMounted=!0,this._pendingLocation&&this.setState({location:this._pendingLocation})},n.componentWillUnmount=function(){this.unlisten&&this.unlisten()},n.render=function(){return o.createElement(f.Provider,{value:{history:this.props.history,location:this.state.location,match:e.computeRootMatch(this.state.location.pathname),staticContext:this.props.staticContext}},o.createElement(d.Provider,{children:this.props.children||null,value:this.props.history}))},e}(o.Component);o.Component;o.Component;var m={},v=0;function g(t,e){void 0===e&&(e={}),("string"==typeof e||Array.isArray(e))&&(e={path:e});var n=e,r=n.path,o=n.exact,i=void 0!==o&&o,a=n.strict,u=void 0!==a&&a,c=n.sensitive,s=void 0!==c&&c;return[].concat(r).reduce((function(e,n){if(!n&&""!==n)return null;if(e)return e;var r=function(t,e){var n=""+e.end+e.strict+e.sensitive,r=m[n]||(m[n]={});if(r[t])return r[t];var o=[],i={regexp:l()(t,o,e),keys:o};return v<1e4&&(r[t]=i,v++),i}(n,{end:i,strict:u,sensitive:s}),o=r.regexp,a=r.keys,c=o.exec(t);if(!c)return null;var p=c[0],d=c.slice(1),f=t===p;return i&&!f?null:{path:n,url:"/"===n&&""===p?"/":p,isExact:f,params:a.reduce((function(t,e,n){return t[e.name]=d[n],t}),{})}}),null)}var y=function(t){function e(){return t.apply(this,arguments)||this}return(0,r.Z)(e,t),e.prototype.render=function(){var t=this;return o.createElement(f.Consumer,null,(function(e){e||(0,u.Z)(!1);var n=t.props.location||e.location,r=t.props.computedMatch?t.props.computedMatch:t.props.path?g(n.pathname,t.props):e.match,i=(0,c.Z)({},e,{location:n,match:r}),a=t.props,s=a.children,l=a.component,p=a.render;return Array.isArray(s)&&0===s.length&&(s=null),o.createElement(f.Provider,{value:i},i.match?s?"function"==typeof s?s(i):s:l?o.createElement(l,i):p?p(i):null:"function"==typeof s?s(i):null)}))},e}(o.Component);function w(t){return"/"===t.charAt(0)?t:"/"+t}function b(t,e){if(!t)return e;var n=w(t);return 0!==e.pathname.indexOf(n)?e:(0,c.Z)({},e,{pathname:e.pathname.substr(n.length)})}function O(t){return"string"==typeof t?t:(0,i.Ep)(t)}function _(t){return function(){(0,u.Z)(!1)}}function E(){}var S=function(t){function e(){for(var e,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))||this).handlePush=function(t){return e.navigateTo(t,"PUSH")},e.handleReplace=function(t){return e.navigateTo(t,"REPLACE")},e.handleListen=function(){return E},e.handleBlock=function(){return E},e}(0,r.Z)(e,t);var n=e.prototype;return n.navigateTo=function(t,e){var n=this.props,r=n.basename,o=void 0===r?"":r,a=n.context,u=void 0===a?{}:a;u.action=e,u.location=function(t,e){return t?(0,c.Z)({},e,{pathname:w(t)+e.pathname}):e}(o,(0,i.ob)(t)),u.url=O(u.location)},n.render=function(){var t=this.props,e=t.basename,n=void 0===e?"":e,r=t.context,a=void 0===r?{}:r,u=t.location,s=void 0===u?"/":u,l=(0,p.Z)(t,["basename","context","location"]),d={createHref:function(t){return w(n+O(t))},action:"POP",location:b(n,(0,i.ob)(s)),push:this.handlePush,replace:this.handleReplace,go:_(),goBack:_(),goForward:_(),listen:this.handleListen,block:this.handleBlock};return o.createElement(h,(0,c.Z)({},l,{history:d,staticContext:a}))},e}(o.Component);var P=function(t){function e(){return t.apply(this,arguments)||this}return(0,r.Z)(e,t),e.prototype.render=function(){var t=this;return o.createElement(f.Consumer,null,(function(e){e||(0,u.Z)(!1);var n,r,i=t.props.location||e.location;return o.Children.forEach(t.props.children,(function(t){if(null==r&&o.isValidElement(t)){n=t;var a=t.props.path||t.props.from;r=a?g(i.pathname,(0,c.Z)({},t.props,{path:a})):e.match}})),r?o.cloneElement(n,{location:i,computedMatch:r}):null}))},e}(o.Component);var Z=o.useContext;function x(){var t=Z(f).match;return t?t.params:{}}}}]);