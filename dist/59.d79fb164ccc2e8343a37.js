(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[59],{969:function(e,t,a){"use strict";var i={sendFacebookPixelEvent:a(340).default.sendFacebookPixelEvent.bind(void 0)};t.Z=i},967:function(e,t,a){"use strict";a.r(t);var i=a(321),r=a(336),o=a.n(r),n=a(308),s=a(968),c=a(969),d=a(970),m={},u={setCustomDimensions:function(e){m=e},getCustomDimensions:function(){return m||{}}};if("undefined"!=typeof window){if(location.origin===n.Z.readymag_auth_host&&s.Z?u=o().Model.extend(i.Z.extend(i.Z.extend(u,s.Z),c.Z)):d.Z?u=o().Model.extend(i.Z.extend(i.Z.extend(u,d.Z),c.Z)):console.error("Analytics initialization error!"),window.RM&&window.RM.customAnalyticsHandlers&&!i.Z.isEmpty(window.RM.customAnalyticsHandlers.event)){var l=u.prototype.sendEvent;u.prototype.sendEvent=function(){if(window.ga){var e=l.apply(this,arguments);return window.RM.customAnalyticsHandlers&&i.Z.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("event",e),e}}}if(window.RM&&window.RM.customAnalyticsHandlers&&!i.Z.isEmpty(window.RM.customAnalyticsHandlers.track)){var g=u.prototype.trackPage;u.prototype.trackPage=function(){if(window.ga){var e=g.apply(this,arguments);return e&&window.RM.customAnalyticsHandlers&&i.Z.isFunction(window.RM.customAnalyticsHandlers.run)&&window.RM.customAnalyticsHandlers.run("track",e),e}}}}t.default=u},970:function(e,t,a){"use strict";var i=a(336),r=a.n(i),o=a(321),n=a(340),s=a(341),c=a(346),d=a(682),m={initialize:function(e){var t,a;o.Z.bindAll(this),o.Z.extend(this,e),(0,c._)("viewer.reactEntrypoint")||this.router||(this.router=RM.viewerRouter||RM.homepageRouter||RM.collectorRouter),this.lastTrackedUrl="",this.shortlink_redirect=n.default.getCookie("shortlink_redirect"),this.initialTracking();var i=RM.common.isNewMainPage,r=null===(t=window.ServerData)||void 0===t||null===(a=t.config)||void 0===a?void 0:a.OPTIMIZE_MAIN_PAGE_AB_ID;if(window.gtag&&void 0!==i&&r){var s=i?1:0;window.gtag("set",{experiments:[{id:r,variant:s}]})}RM.common.readymagTracker&&n.default.loadLoggedUser(o.Z.bind((function(e){!o.Z.isEmpty(e)&&window.ga&&(window.ga&&window.ga("readymag.set","&uid",e._id),this.userId=e._id)}),this))},setClientIdFromCookie:function(){var e=n.default.getCookie("_ga");if(e){var t=e.match(/GA[0-9]+\.[0-9]+\.(.*)/),a=t.length>1?t[1]:void 0;a&&window.gtag("set",{client_id:a})}},sendEvent:function(e,t,a,i){if(window.gtag){if(!RM.common.isDomainViewer){var r=window.ServerData&&!window.ServerData.isCountryInEU&&window.Cookiebot&&!window.Cookiebot.declined,n=window.Cookiebot&&window.Cookiebot.consent.statistics;if(window.ServerData&&window.ServerData.isCountryInEU){if(!n&&!RM.common.isDomainViewer)return}else if(!r&&!RM.common.isDomainViewer)return}this.setClientIdFromCookie();var s={action:e};o.Z.isObject(t)?s=o.Z.extend(s,t):(s.label=t||void 0,s.value=a||void 0);var c=this._extendParams(s);c.label&&"string"==typeof c.label&&c.label.match(/enterprise/)&&(c.label=c.label.replace(/enterprise/,"custom"));var d={hitType:"event",eventCategory:c.category,eventAction:c.action,eventLabel:c.label,eventValue:c.value,page:c.page,location:c.href,screenName:c.screenName,hitCallback:i||c.cb||void 0};return RM.common.readymagTracker&&(c.dims&&c.dims.userId&&(d.dimension2=c.dims.userId),window.gtag("event",d.eventAction,{event_category:d.eventCategory,event_label:d.eventLabel,pageType:c.dims&&c.dims.pageType,userId:c.dims&&c.dims.userId,dimension:this._rmdata&&this._rmdata.dimension,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium}})),RM.common.userTracker&&"Project Actions"===c.category&&window.gtag("event",d.eventAction,{event_category:d.eventCategory,event_label:d.eventLabel,value:d.eventValue}),RM.common.readymagTracker&&this.sendFacebookPixelEvent(c.action,c),d}},trackPage:function(e){if(window.gtag){this.setClientIdFromCookie();var t=this._extendParams(e);if(this.shortlink_redirect&&(t=o.Z.extend(t,this._processRedirectUTM())),t.page!==this.lastTrackedUrl||RM.common.homepageRewrite){this.lastTrackedUrl=t.page;var a={page:t.page,location:t.href,screenName:t.screenName,campaignName:t.campaignName,campaignSource:t.campaignSource,campaignMedium:t.campaignMedium,hitCallback:t.cb||void 0};return RM.common.readymagTracker&&(t.dims&&t.dims.userId&&(a.dimension2=t.dims.userId),a.metric1=t.countProjectView,window.gtag("event","page_view",{page_title:window.document.title,page_location:t.location||t.href,pageType:t.dims&&t.dims.pageType,userId:t.dims&&t.dims.userId,dimension:this._rmdata&&this._rmdata.dimension,firstCampaign:this._rmdata&&this._rmdata.first_campaign,firstMedium:this._rmdata&&this._rmdata.first_medium,campaign:{name:this._rmdata&&this._rmdata.first_campaign,source:this._rmdata&&this._rmdata.first_source,medium:this._rmdata&&this._rmdata.first_medium}})),RM.common.userTracker&&window.gtag("event","page_view",{page_title:window.document.title,page_location:t.location||t.href}),RM.common.readymagTracker&&this.sendFacebookPixelEvent("PageView"),a}}},_extendParams:function(e){var t=e||{};return RM.common.isDownloadedSource||RM.common.homepageRewrite||((0,c._)("viewer.reactEntrypoint")?t.dims=this._parseDimensions(this.getCustomDimensions()):t.dims=this.router.getAnalyticsDimensions&&this._parseDimensions(this.router.getAnalyticsDimensions())),this.userId&&t.dims&&(t.dims.userId=this.userId),t.page||RM.common.isDownloadedSource||RM.common.homepageRewrite?t.page||!RM.common.isDownloadedSource||RM.common.homepageRewrite||(t.page=r().history.location.pathname):t.page="/"+r().history.getFragment(),t.page&&-1!==t.page.indexOf("?")&&(t.page=t.page.substr(0,t.page.indexOf("?"))),t.page=this._correctUrl(t.page||""),t.href=window.location.href,t.action&&!t.category&&(t.category=this.getActionCategory(t.action)),this._triggerProjectView&&!t.action&&(t.countProjectView=1,this._triggerProjectView=!1),t.screenName=this._setScreenName(),t},_correctUrl:function(e){return"/"===e?e:"/"===e[e.length-1]?e.substr(0,e.length-1):e},_setScreenName:function(){var e;return RM.viewerRouter&&RM.viewerRouter.mag&&RM.viewerRouter.magPasswordView&&RM.viewerRouter.mag.is_private&&(e="Private project "+RM.viewerRouter.mag.num_id),RM.viewerRouter&&RM.viewerRouter.mag&&!RM.viewerRouter.mag.is_private&&(e=RM.viewerRouter.mag.title),e},_parseDimensions:function(e){return{pageType:e.pageType,userId:e.userId,subscription:e.subscription}},_processRedirectUTM:function(){if(this.shortlink_redirect){var e=JSON.parse(atob(this.shortlink_redirect));return n.default.deleteCookie("shortlink_redirect"),{campaignName:e.utm_campaign,campaignSource:e.utm_source,campaignMedium:e.utm_medium}}},trackABMainPage:function(){var e=RM.common.isNewMainPage;if(void 0!==e){if(!n.default.getCookie("_rm_main_page")){var t=e?"new":"old";n.default.createCookie("_rm_main_page",t)}this.sendEvent(d.HI.LandingJanuary2022,n.default.getMainPageGALabel("Visit",e))}},initialTracking:function(){var e=this;this._rmdata=n.default.createRmDataCookie(),RM.common.isDomainViewer?this.trackPage():s.Z.waitForCookieConsent().then((function(t){t.statistics?(e.trackABMainPage(),e.trackPage()):n.default.deleteCookie("_rmdata")}))},getActionCategory:function(e){return RM.homepageRouter?"Homepage Actions":"First Widget Pack Loaded"===e?"Performance":e===d.HI.LandingJanuary2022?"Experiments":"Project Actions"}};t.Z=m},968:function(e,t,a){"use strict";var i=a(312),r=a(336),o=a.n(r),n=a(321),s=a(340),c=a(308),d=a(682),m={initialize:function(e){var t,a;if(n.Z.bindAll(this),n.Z.extend(this,e),this.currentData=this._initCurrentData(),this.router||(this.router=RM.collectorRouter||RM.constructorRouter),this.currentData.userId&&!RM.common.isDownloadedSource){var r=this.currentData.userId;window.ga("readymag.set","&uid",r),window.ga("readymag.set","&cd2",r),window.ga("readymag.set","&cd9",r),window.ga("readymag.set","&cd13",this.currentData.gacid)}var o=RM.common.isNewMainPage,s=null===(t=window.ServerData)||void 0===t||null===(a=t.config)||void 0===a?void 0:a.OPTIMIZE_MAIN_PAGE_AB_ID;if(void 0!==o&&s){var c=o?1:0;window.ga("readymag.set","exp","".concat(s,".").concat(c))}this.lastTrackedUrl="",(0,i.ZP)(n.Z.bind((function(){this.initialTracking()}),this))},initialTracking:function(){var e=s.default.getCookie("_rm_reg_cookie"),t=s.default.getCookie("_rm_join_analytics_data");this.trackPage(),e&&(RM.common.isDownloadedSource||(s.default.sendFacebookPixelEvent(c.Z.FacebookTrackingEvents.Join,{value:2,currency:"USD"}),s.default.trackPinterestConversion(c.Z.PinterestTrackingEvents.Join)),this.sendEvent("Joined Frontend",void 0,void 0,(function(){s.default.deleteCookie("_rm_reg_cookie")}))),t&&s.default.deleteCookie("_rm_join_analytics_data")},sendEvent:function(e,t,a,i){if(window.ga&&(!RM.constructorRouter||!RM.constructorRouter.previewMode)){var r={action:e};n.Z.isObject(t)?r=n.Z.extend(r,t):(r.label=t||void 0,r.value=a||void 0);var o=this._extendParams(r);o.label&&"string"==typeof o.label&&o.label.match(/enterprise/)&&(o.label=o.label.replace(/enterprise/,"custom"));var s={hitType:"event",eventCategory:o.category,eventAction:o.action,eventLabel:o.label,eventValue:o.value,page:o.page,screenName:o.screenName,location:o.href,hitCallback:i||o.cb||void 0};this._rmdata&&(s.campaignName=this._rmdata.first_campaign,s.campaignSource=this._rmdata.first_source,s.campaignMedium=this._rmdata.first_medium),window.ga("readymag.send",s),this.sendFacebookPixelEvent(o.action,o)}},trackPage:function(e){if(window.ga&&!(RM.constructorRouter&&RM.constructorRouter.previewMode||n.Z.has(RM.common.disableShortcuts,"help-tour"))){var t=this._extendParams(e);if(t.hitType="pageview",t.page!==this.lastTrackedUrl){this.lastTrackedUrl=t.page;var a={page:t.page,location:t.href,screenName:t.screenName,hitCallback:t.cb||void 0};t.dims.userId&&(a.dimension2=t.dims.userId),this._rmdata&&(a.campaignName=this._rmdata.first_campaign,a.campaignSource=this._rmdata.first_source,a.campaignMedium=this._rmdata.first_medium),window.ga("readymag.send","pageview",a),this.sendFacebookPixelEvent("PageView")}}},_initCurrentData:function(){var e={userId:null};window.ServerData.me&&(e.userId=window.ServerData.me._id||window.ServerData.me.user&&window.ServerData.me.user._id,e.userEmail=window.ServerData.me.email||window.ServerData.me.user&&window.ServerData.me.user.email,e.userFullName=window.ServerData.me.name||window.ServerData.me.user&&window.ServerData.me.user.name,e.subscription=this._getSubscription()),e.gacid=s.default.getGAcid();var t=s.default.getCookie("_rmdata");return t&&(this._rmdata=JSON.parse(atob(t))),e},_getSubscription:function(){var e=window.ServerData.me.stripe&&window.ServerData.me.stripe.subscription_id||window.ServerData.me.user&&window.ServerData.me.user.stripe&&window.ServerData.me.user.stripe.subscription_id,t="",a="",i="";return e&&"none"!==e.toLowerCase()?((e=e.toLowerCase())&&/yearly/g.test(e)?i="yearly":e&&/monthly/g.test(e)&&(i="monthly"),a=(a=(a=(a=(a=(a=e).replace(/ /g,"")).replace(/_/g,"")).replace(/(yearly|monthly)/g,"")).replace(/plan/g,"")).trim(),t="paid"):(t="free",a=""),(t+" "+a+" "+i).trim()},_parseDimensions:function(e){var t={magId:e.magId,pageType:e.pageType,userId:e.userId};return e.magCreatorId&&(t.magCreatorId=e.magCreatorId),RM.constructorRouter&&!RM.constructorRouter.isOwner&&(t.pageType="constructor shared"),t.subscription=this.currentData.subscription||"free",t},_correctUrl:function(e){return"/"===e?e:"/"===e[e.length-1]?e.substr(0,e.length-1):e},_extendParams:function(e){var t=e||{};return t.dims=this.router.getAnalyticsDimensions&&this._parseDimensions(this.router.getAnalyticsDimensions()),t.page||(t.page="/"+o().history.getFragment()),-1!==t.page.indexOf("?")&&(t.page=t.page.substr(0,t.page.indexOf("?"))),t.page=this._correctUrl(t.page),t.href=window.location.href,t.action&&(t.category=t.customCategory||this.getActionCategory(t.action)),t.label&&(t.label=t.label.toString()),t.screenName=this._setScreenName(),t},_setScreenName:function(){var e;return RM.constructorRouter&&RM.constructorRouter.previewMode&&(e="Preview "+RM.constructorRouter.mag.get("num_id")),RM.constructorRouter&&!RM.constructorRouter.previewMode&&(e="Constructor "+RM.constructorRouter.mag.get("num_id")),RM.collectorRouter&&"shared-folder"!==RM.collectorRouter.currentView.mode&&(e="Profile ‘"+RM.collectorRouter.currentView.user.get("name")+"’"),RM.collectorRouter&&"shared-folder"===RM.collectorRouter.currentView.mode&&(e="Profile (shared folder) ‘"+RM.collectorRouter.currentView.user.get("name")+"’"),e},_getUserParam:function(e){return(this.router&&this.router.me&&this.router.me.attributes||{})[e]},getActionCategory:function(e){var t="";switch(e){case d.HI.LandingJanuary2022:t="Experiments";break;case"Joined":case"Subscribed":case"Subscribe Error":case"Resumed Subscription":case"Changed Subscription":case"Coupon Applied":case"Cancelled Subscription":case"Cancelled Autorenew":t="Basic User Actions";break;case"Customer New":case"Customer":case"User (free)":t="Status of the day";break;case"Manage Subscription":case"Submit To Explore":case"Explore Tab Click":t="Homepage Actions";break;case"Animation Type Change":case"Animation Add Type":case"Animation Use Preset":case"Animation Choose Effect":case"Animation Trigger Click":case"Font Selector Show":case"Font Selector Switch to Category":case"Font Selector Show Custom Font Panel":case"Font Explorer Add/Remove from Library":case"Font Selector Edit List":case"Font Selector Custom Font Panel Select Weight":case"Font Selector Custom Font Panel Upload Weight":case"Font Selector Edit Custom Font":case"Create Mag Request":case"Create Mag":case"Publish Mag":case"Republish Mag":case"Unpublish Mag":case"Create Widget":case"Create Page":case"Page SEO Open":case"Page Sharing Open":case"Page Restored":case"Restore Defaults Sharing":case"Master Page Sharing":case"Help Open":case"Constructor Help Open":case"Code Editor Open":case"Code Editor Switch Tab":case"Code Editor Update":case"Code Editor Clear Switcher":case"Code Editor Use Iframe Switcher":case"Add Team Member":case"Delete Team Member":case"Picture Scale":case"Background Widget Type":case"Viewer Type Toggle":case"Viewer Options Toggle":case"Viewer Settings Learn More Click":case"Project Visible to Search Engines":case"Password Toggle":case"Set Project Password":case"Project Visibile to Visitors":case"Form Storage Connect Click":case"Form Storage Set Endpoint Param":case"Form Storage Successful OAuth Result":case"Map Domain":case"SSL Toggle":case"PDF Export":case"HTML Export":case"Set Project GA":case"Set Project GTM":case"GA Upgrade":case"Key Press":case"Restore to published":case"Picture Settings":case"Stripe":case"Viewports":case"Restore Layout":default:t="Process Actions"}return t}};t.Z=m}}]);