(self.webpackChunkrm_frontend=self.webpackChunkrm_frontend||[]).push([[67],{1488:function(e,t,n){"use strict";n.r(t),n.d(t,{ViewerRouter:function(){return oe},startViewer:function(){return ie}});var r=n(354),o=n(675),i=n(1486),a=n(1475),l=n(322),c=n(641),u=n(308),s=n(1403),d=n(1107),m=r.createContext({}),f=n(1379),p=n(340),g=n(1384),h=n(1300),w=n(967);function v(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function y(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var E=function(e){var t=e.pageUri,o=(0,r.useContext)(m),i=o.isDomainViewer,b=o.domainForUser,E=o.project,x=o.isDownloadedSource,S=o.homepageRewrite,P=y((0,r.useState)(null),2),j=P[0],_=P[1],I=(0,a.k6)();return(0,r.useEffect)((function(){if(j&&t){var e=parseInt(t,10).toString()===t?j.getPage(t):j.getPageByPath(t||"1");e&&j.showPage(e.num)}}),[t]),(0,r.useEffect)((function(){if(E){var e,r;s.ZP.setTiming(s.qK.MagLoaded,Date.now());var o={environment:u.Z.environment.viewer,navigate:function(e,t){t.replace?I.replace(e):I.push(e)},setUrlString:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=a.currentPage;if(e=i&&!b||x?"":o.getMagUri(),n&&"1"!==n.num&&(e+=(n.pagePath||n.uri||n.num.toString())+"/"),e!==I.location.pathname){var r=parseInt(l.default.last(I.location.pathname.split("/"))||"",10)||1,c=r===n.num||t.replace;x&&"/"!==l.default.last(e)&&(e+="/"),S||o.navigate("/".concat(e),{replace:c})}},setTitle:function(){if(a&&a.currentPage){var e=d.getFinalSEO(a.currentPage,a,{customDomain:!!i});document.title=e.title}},getMagUri:function(){return b?(a.uri||a.num_id)+"/":i?"":l.default.isEmpty(a.user)?"".concat(a.num_id,"/"):"".concat(a.user.uri,"/").concat(a.uri||a.num_id,"/")},go:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1?arguments[1]:void 0;if(t.isPageNum)a.showPage(e,t);else{var n=a.getPageByPath(e)||{};a.showPage(n.num||e,t)}},restartMag:function(){window.location.reload()},onError:function(){a&&o.go(1,{animation:!1})}},a=new f.Z(window.ServerData.mags.mag,o);_(a),window.RM.viewerRouter={mag:a,environment:u.Z.environment.viewer,createMagFromTemplate:(P=regeneratorRuntime.mark((function e(t,r){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.e(58).then(n.bind(n,1426));case 2:new(0,e.sent.default)({router:window.RM.viewerRouter,me:window.RM.data.usersLoader.me,tp:t,templateID:r});case 5:case"end":return e.stop()}}),e)})),j=function(){var e=this,t=arguments;return new Promise((function(n,r){var o=P.apply(e,t);function i(e){v(o,n,r,i,a,"next",e)}function a(e){v(o,n,r,i,a,"throw",e)}i(void 0)}))},function(e,t){return j.apply(this,arguments)})},function(e){if(!u.Z.isScreenshot&&!window.RM.common.isDownloadedSource){var t,r,o,i=!0===(null===(t=window.RM)||void 0===t||null===(r=t.common)||void 0===r?void 0:r.isDomainViewer);u.Z.isProd&&!i&&n.e(52).then(n.bind(n,1472)).then((function(e){(0,e.getWebVitals)()})),(0,c.G_)(e.num_id);var a=new w.default;a.setCustomDimensions({magId:e.num_id,magCreatorId:null===(o=e.user)||void 0===o?void 0:o._id,pageType:"viewer",userId:null}),window.RM.analytics=a,window.RM.analytics&&(window.RM.analytics._triggerProjectView=!0)}}(a),a.hasNewTextWidgets()&&(0,h.IB)("viewer");var m=a.getPageByPath(t||"1")||{},y=null===(e=a.model)||void 0===e||null===(r=e.attributes)||void 0===r?void 0:r.usedWidgetTypes;(0,g.preloadWidgets)(null!=y&&y.length?y:p.default.usedWidgets(a.pages||[],a.aboveGlobalWidgetsData)).finally((function(){a.render(),a.showPage(m?m.num:1),s.ZP.setTiming(s.qK.MagRendered,Date.now());var e=a.currentPage.num,t=a.pages.reduce((function(e,t){return e+(t.widgets?t.widgets.length:0)}),0)+a.aboveGlobalWidgets.length;setTimeout((function(){s.ZP.setTiming(s.qK.DomComplete,window.performance.timing.domComplete),s.ZP.sendTimings({projectNumId:a.num_id,userNumId:a.user.num_id,viewport:a.viewport,startPage:e,widgetsCount:t})}),1e4)}))}var P,j}),[]),r.createElement("div",null)},x=function(){var e=(0,a.UO)().pageUri;return r.createElement(E,{pageUri:e})},S=n(652),P=n(954),j=n(1002),_=n.n(j),I=n(1489),C=function(){return r.createElement("svg",{version:"1.2",baseProfile:"tiny",xmlns:"http://www.w3.org/2000/svg",opacity:"0.1",width:"100%",height:"100%"},r.createElement("g",null,r.createElement("line",{x1:"0",x2:"100%",y1:"0",y2:"100%",stroke:"#ff4828"}),r.createElement("line",{x1:"100%",x2:"0",y1:"0",y2:"100%",stroke:"#ff4828"})))},k=function(e){var t=e.title,n=e.content,o=e.helpButton,i=e.showLogo,a=e.showCrossLines,l=e.dark,c=i||o;return r.createElement(P.Box,{display:"flex",alignItems:"center",flexDirection:"column",height:"100vh",width:"100vw",bg:l?"#000":"#fafafa"},a&&r.createElement(P.Box,{position:"absolute",left:0,top:0,width:"100%",height:"100%",zIndex:0},r.createElement(C,null)),r.createElement(O,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",maxWidth:460,position:"relative",zIndex:1},r.createElement(P.Box,{bg:a?"#fafafa":void 0,p:a?3:void 0},r.createElement(_(),{as:"h2",textStyle:"subheading",textAlign:"center",color:l&&"white"},t),r.createElement(_(),{as:"div",mt:2,textAlign:"center",color:l?"rgba(255,255,255,0.5)":"gray"},n))),c&&r.createElement(P.Box,{width:"100%",display:"flex",alignItems:"center",justifyContent:"space-between",mb:4,pl:4,pr:4,position:"relative",zIndex:1},r.createElement(P.Box,{width:"100%"}),r.createElement(P.Box,{width:"100%",textAlign:"center"},i&&r.createElement(j.StyledLink,{href:"https://".concat(u.Z.readymag_host)},r.createElement(I.Z,{color:l?"rgba(255, 255, 255, 0.5)":"#000",hoverColor:l?"rgba(255, 255, 255, 1)":"#000",size:20}))),r.createElement(_(),{as:"div",width:"100%",textAlign:"right"},o)))},R=function(){return r.createElement(k,{title:"Page not found",content:r.createElement(r.Fragment,null,"Sorry, there’s nothing here. ",r.createElement("br",null),"Visit our ",r.createElement(j.StyledLink,{href:"/"},"front page"),".")})},B=function(e){var t=e.type;return r.createElement(k,{title:"Suspended",showCrossLines:!0,content:r.createElement(r.Fragment,null,"Sorry, this ",t," has been suspended due to violation of Readymag’s"," ",r.createElement(j.StyledLink,{href:"https://readymag.com/readymag/terms-and-privacy"},"content guidelines"),"."),helpButton:r.createElement(j.StyledLink,{href:"mailto:".concat(u.Z.SUPPORT_MAIL)},"Contact us")})},D=function(){return r.createElement(k,{title:"Website is almost here",content:r.createElement(r.Fragment,null,"To complete the setup, please hit the “Connect domain” ",r.createElement("br",null)," button in your projects’s settings."),helpButton:r.createElement(j.StyledLink,{color:"rgba(255,255,255,0.5)",href:"https://help.readymag.com/hc/en-us/articles/4403970232091-Mapping-a-domain"},"Need help?"),showLogo:!0,dark:!0})},L=function(){return r.createElement(k,{title:"Website is Offline",content:"This project has been unpublished",showLogo:!0,dark:!0})},M=function(){return r.createElement(k,{title:"Website is Offline",content:r.createElement(r.Fragment,null,r.createElement(j.StyledLink,{href:"".concat(u.Z.readymag_auth_host,"/settings/")},"Log in")," to manage your subscription."),showLogo:!0,dark:!0})},O=(0,S.default)(P.Box).withConfig({displayName:"ServicePages___StyledBox",componentId:"sc-xgqhq9-0"})(["flex-grow:1;"]),Z=n(1022),A=n(1016),F=n.n(A),z=n(1244),N=n(1491),T=n(1490),U=n(668),W=n(667),V=n(1011),q=function(e){return window.RM.common.customDomainProfile?"/":window.RM.common.isDomainViewer?"".concat(u.Z.readymag_host,"/").concat(e.uri):"/".concat(e.uri)};function K(e,t,n,r,o,i,a){try{var l=e[i](a),c=l.value}catch(e){return void n(e)}l.done?t(c):Promise.resolve(c).then(r,o)}function $(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"==typeof Symbol||!(Symbol.iterator in Object(e)))return;var n=[],r=!0,o=!1,i=void 0;try{for(var a,l=e[Symbol.iterator]();!(r=(a=l.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{r||null==l.return||l.return()}finally{if(o)throw i}}return n}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return G(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return G(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function G(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var H,J=S.default.form.withConfig({displayName:"Forbidden__Form",componentId:"sc-i0zssw-0"})(["width:100%;max-width:418px;flex-grow:1;display:flex;align-items:center;justify-content:center;"]),Y=function(){var e,t,n,o=$((0,r.useState)(""),2),i=o[0],a=o[1],l=$((0,r.useState)(!1),2),s=l[0],d=l[1],f=(0,r.useContext)(m),p=f.publicPath,g=f.project,h=(null==g?void 0:g.pass_bg)||"".concat(p,"/img/viewer/mag-password/bg.jpg"),w=(0,T.Y)(h),v=(0,r.useRef)(null),y=null==g?void 0:g.user,b=!(null!=g&&null!==(e=g.user)&&void 0!==e&&e.permissions)||!1===(null==g||null===(t=g.user)||void 0===t||null===(n=t.permissions)||void 0===n?void 0:n.white_label);(0,r.useEffect)((function(){var e;null===(e=v.current)||void 0===e||e.focus()}),[]);var E=function(){var e,t=(e=regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!g){e.next=7;break}return e.next=4,(0,c.eq)(i,null==g?void 0:g.num_id);case 4:window.location.reload(),e.next=8;break;case 7:d(!0);case 8:e.next=13;break;case 10:e.prev=10,e.t0=e.catch(0),d(!0);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(e){K(i,r,o,a,l,"next",e)}function l(e){K(i,r,o,a,l,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return r.createElement(P.Box,{justifyContent:"center",height:"100vh",width:"100vw",bg:"#000"},r.createElement(P.Cover,{position:"absolute",left:0,top:0,width:"100%",height:"100%",backgroundImage:"url('".concat(h,"')"),backgroundRepeat:"no-repeat",backgroundSize:"cover",backgroundPosition:"center",opacity:w?1:0,transition:".4s ease opacity",zIndex:0}),r.createElement(P.Box,{display:"flex",width:"100%",height:"100%",alignItems:"center",flexDirection:"column",position:"relative",zIndex:1},b&&y&&r.createElement(P.Box,{width:"100%",pl:4,pt:4,display:"flex",alignItems:"center",justifyContent:"flex-start"},r.createElement(P.Box,{pr:12},r.createElement(j.StyledLink,{href:q(y)},r.createElement(V.ResponsiveAvatar,{url:y.pic,name:y.name,size:"medium"}))),r.createElement(P.Box,null,r.createElement(_(),{as:"div",fontSize:14,lineHeight:"18px",color:(0,U.transparentize)(.5,W.colors.white)},"Published by"),r.createElement(_(),{as:"div",fontSize:20,lineHeight:"24px",color:"white"},y.name))),r.createElement(J,{onSubmit:function(e){e.preventDefault(),E()}},r.createElement(N.Z,{state:s,onDone:function(){return d(!1)},style:{width:"100%"}},r.createElement(Q,{display:"flex",alignItems:"center",justifyContent:"space-between",bg:"white",borderRadius:25,height:50,width:"100%",$_css:z.default.fixRadiusClip()},r.createElement(P.Box,{height:"100%",width:"100%",p:"0 6px 0 25px"},r.createElement(Z.default,{ref:v,type:"password",value:i,onChange:function(e){return a(e.target.value)},border:"none",p:0,height:"100%",placeholder:"Enter password",fontSize:20})),r.createElement(P.Box,{height:"100%"},r.createElement(F(),{borderRadius:"0 25px 25px 0",width:110,height:"100%",color:"white",background:i.length?"#0078ff":"#999",disabled:!i,onClick:E,variant:"clean",fontSize:20},"Open"))))),b&&r.createElement(P.Box,{width:"100%",pl:4,pb:4},r.createElement(_(),{as:"div",color:(0,U.transparentize)(.7,W.colors.white),fontSize:11,lineHeight:"14px"},"Made with"),r.createElement(j.StyledLink,{href:"https://".concat(u.Z.readymag_host)},r.createElement(I.Z,{color:(0,U.transparentize)(.7,W.colors.white),hoverColor:"white",size:18})))))},Q=(0,S.default)(P.Box).withConfig({displayName:"Forbidden___StyledBox",componentId:"sc-i0zssw-1"})(["",""],(function(e){return e.$_css}));!function(e){e.ProjectNotFound="ProjectNotFound",e.ProjectNotPublished="ProjectNotPublished",e.DomainNotFound="DomainNotFound",e.SubscriptionExpired="SubscriptionExpired",e.Forbidden="Forbidden",e.ProjectSuspended="ProjectSuspended",e.UserSuspended="UserSuspended"}(H||(H={}));var X=function(e){switch(e.type){case H.ProjectNotFound:return r.createElement(R,null);case H.DomainNotFound:return r.createElement(D,null);case H.ProjectSuspended:return r.createElement(B,{type:"project"});case H.UserSuspended:return r.createElement(B,{type:"account"});case H.ProjectNotPublished:return r.createElement(L,null);case H.SubscriptionExpired:return r.createElement(M,null);case H.Forbidden:return r.createElement(Y,null);default:return r.createElement(R,null)}},ee=n(1487),te=n(602);function ne(e){var t=document.getElementById("root");te.hydrate(r.createElement(e,function(){try{var e=document.getElementById("__RM_PROPS__");return null!=e&&e.textContent?JSON.parse(e.innerText):{}}catch(e){return{}}}()),t)}function re(e,t){if(null==e)return{};var n,r,o=function(e,t){if(null==e)return{};var n,r,o={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(o[n]=e[n]);return o}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}var oe=function(e){var t=e.location,n=e.ssr,l=re(e,["location","ssr"]),c=["/:user/:project/num/:pageNum","/:user/:project/:pageUri*"];l.isDomainViewer&&(l.domainForUser?c.push("/:mag/:pageUri*"):c.push("/:pageUri*")),l.isDownloadedSource&&(c.push("/:pageUri*"),/msie [6-9]/i.test(navigator.userAgent)&&"undefined"!=typeof window&&(window.location.href="sorry.html")),(0,r.useEffect)((function(){s.ZP.setTiming(s.qK.DomLoaded,window.performance.timing.domLoading),s.ZP.setTiming(s.qK.ScriptsLoaded,window.performance.timing.domContentLoadedEventEnd),s.ZP.setTiming(s.qK.RouterInit,Date.now())}),[]);var u=function(e){var o=e.children;return n?r.createElement(a.gx,{location:t},o):r.createElement(i.VK,null,o)},d=l.errorPage?r.createElement(X,{type:l.errorPage}):r.createElement(u,null,r.createElement(a.rs,null,r.createElement(a.AW,{path:c},r.createElement(x,null))));return r.createElement(m.Provider,{value:l},r.createElement(o.Z,null,r.createElement(ee.Z,null),d))},ie=function(){ne(oe)}}}]);